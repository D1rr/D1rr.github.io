---
layout: post
title: Luogu P4391 [BOI2009]Radio Transmission
tag: [题解]
---
### [$Luogu$ $P4391$ [BOI2009]Radio Transmission](https://www.luogu.com.cn/problem/P4391)  
题意：给你一个长度为$n$字符串$S$，若它是一个字符串$s$自我复制产生的字符串的一个子串，求这个原字符串$s$的最小长度。  

### 结论：$ans=n-kmp[n]$  
至于原因会在下文中证明。  
* 先考虑一个简单的情况。  
如有字符串`aba`，那么这个字符串是`ab`复制一遍后的子串，长度为$2$。  
得到这个字符串的方法是考虑$kmp[n]$，发现在$kmp[n]$所包含的字符之外还有$1$个字符`b`，此时，长度就是$n-kmp[n]$。  
这种情况可以简单归结为字符串只复制一次，表示起来就是$[S_{1},S_{2},S_{1}]$。那么长度就是$Lenth_{S_{1}}+Lenth_{S_{2}}$。  
* 那么如果复制多次会怎样？  
复制多次，那么显而易见的，在$kmp[n]$所包含的元素中，会出现重复的元素。  
我们可以把这时的前缀后缀分别分割成长度对应相同的部分。  
$Str_{1}[S_{1},··,S_{kmp[n]}]$和$Str_{2}[S_{kmp_{[n-1]}},··,S_{n}]$。  
这两个串可以补全成为原串，既然是原串和其前后缀，那么$Str_{2}$补回的部分一定和$Str_{1}$的前面的部分相同。  
而$Str_{1}$相同的部分，根据前缀函数的定义，又和$Str_{2}$中前面一部分相等。  
* 一直同理可得下去，就会发现这样子就匹配了全串。  

$ok$了，这样第一个串就是我们所求的。